<h2>Mes listes</h2>

<input [(ngModel)]="newListName" placeholder="Nom de la liste" />
<button (click)="addList()">Créer</button>
<div *ngIf="errorMessage" style="color: red;">{{ errorMessage }}</div>

<ul>
  <li *ngFor="let list of lists">
    <strong>{{ list.name }}</strong>
    <button (click)="selectList(list.id)">
      {{ selectedListId === list.id ? 'Cacher personnes' : 'Ajouter personnes' }}
    </button>
    <button (click)="deleteList(list.id)">Supprimer</button>

    <div *ngIf="selectedListId === list.id" style="margin-top: 1rem; border: 1px solid #ccc; padding: 10px;">
      <h3>Personnes de la liste {{ list.name }}</h3>

      <form (ngSubmit)="submitPerson()">
        <label>
          Nom :
          <input
            type="text"
            [(ngModel)]="formPerson.lastName"
            name="lastName"
            required minlength="3"
            maxlength="50"
          />
        </label>

        <label>
          Genre :
          <select [(ngModel)]="formPerson.gender" name="gender" required>
            <option value="masculin">Masculin</option>
            <option value="féminin">Féminin</option>
            <option value="ne se prononce pas">Ne se prononce pas</option>
          </select>
        </label>

        <label>
          Aisance en Français :
          <select [(ngModel)]="formPerson.frenchLevel" name="frenchLevel" required>
            <option *ngFor="let lvl of [1, 2, 3, 4]" [value]="lvl">{{ lvl }}</option>
          </select>
        </label>

        <label>
          Ancien DWWM :
          <input type="checkbox" [(ngModel)]="formPerson.isFormerDwwm" name="isFormerDwwm" />
        </label>

        <label>
          Niveau technique :
          <select [(ngModel)]="formPerson.technicalLevel" name="technicalLevel" required>
            <option *ngFor="let lvl of [1, 2, 3, 4]" [value]="lvl">{{ lvl }}</option>
          </select>
        </label>

        <label>
          Profil :
          <select [(ngModel)]="formPerson.profile" name="profile" required>
            <option value="timide">Timide</option>
            <option value="réservé">Réservé</option>
            <option value="à l’aise">À l’aise</option>
          </select>
        </label>

        <label>
          Âge :
          <input
            type="number"
            [(ngModel)]="formPerson.age"
            name="age"
            min="1"
            max="99"
            required
          />
        </label>

        <button type="submit">{{ isEditMode ? 'Modifier' : 'Ajouter' }}</button>
        <button type="button" (click)="cancelPersonForm()" *ngIf="isEditMode">Annuler</button>
      </form>

      <h4>Liste des personnes</h4>
      <table border="1" cellpadding="5" cellspacing="0">
        <thead>
          <tr>
            <th>Nom</th>
            <th>Genre</th>
            <th>Français</th>
            <th>DWWM</th>
            <th>Technique</th>
            <th>Profil</th>
            <th>Âge</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let person of persons">
            <td>{{ person.lastName }}</td>
            <td>{{ person.gender }}</td>
            <td>{{ person.frenchLevel }}</td>
            <td>{{ person.isFormerDwwm ? 'Oui' : 'Non' }}</td>
            <td>{{ person.technicalLevel }}</td>
            <td>{{ person.profile }}</td>
            <td>{{ person.age }}</td>
            <td>
              <button (click)="edit(person)">Modifier</button>
              <button (click)="deletePerson(person.id)">Supprimer</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </li>
</ul>
