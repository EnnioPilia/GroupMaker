<div class="container my-5" *ngIf="list">
  <!-- En-tÃªte -->
  <div class="bg-list-header p-4 mb-4 rounded border border-2 border-custom">
    <h2 class="text-center mb-0">GÃ©nÃ©rateur de groupes</h2>

    <!-- ParamÃ¨tres de gÃ©nÃ©ration -->
    <div class="d-flex flex-wrap align-items-center gap-4 mt-4" style="max-width: 600px;">
      <div class="d-flex align-items-center gap-2">
        <label for="numberOfGroups" class="form-label mb-0">Nombre :</label>
        <input
          type="number"
          id="numberOfGroups"
          [(ngModel)]="numberOfGroups"
          class="form-control"
          style="width: 70px;"
          min="1"
          required
        />
      </div>

      <div class="form-check">
        <input
          id="mixerAncienDwwm"
          type="checkbox"
          class="form-check-input"
          [(ngModel)]="criteria.mixerAncienDwwm"
        />
        <label for="mixerAncienDwwm" class="form-check-label">Mixer DWWM</label>
      </div>

      <div class="form-check">
        <input
          id="mixerAge"
          type="checkbox"
          class="form-check-input"
          [(ngModel)]="criteria.mixerAge"
        />
        <label for="mixerAge" class="form-check-label">Mixer Ã¢ge</label>
      </div>
    </div>
  </div>

  <!-- DÃ©tails de la liste et bouton de gÃ©nÃ©ration -->
  <div class="card p-4 mb-4 border border-custom rounded" style="max-width: 600px;">
    <h4 class="mb-3">{{ list.name }}</h4>

    <form #groupForm="ngForm" (ngSubmit)="generateGroups()" novalidate>
      <div class="text-center">
        <button
          type="submit"
          class="btn btn-primary-custom w-50"
          [disabled]="groupForm.invalid"
        >
          ðŸŽ² GÃ©nÃ©rer les groupes
        </button>
      </div>
    </form>

    <!-- Groupes gÃ©nÃ©rÃ©s -->
    <div *ngIf="list.generatedGroups?.length > 0" class="mt-4">
      <div *ngFor="let group of list.generatedGroups" class="mb-3">
        <h5>{{ group.name }}</h5>
        <ul class="list-unstyled">
          <li
            *ngFor="let person of group.persons"
            class="p-2 mb-2 rounded border d-flex align-items-start"
            style="background-color: #dcb49e;"
          >
            {{ person.lastName }} ({{ person.age }} ans)
            <span *ngIf="person.isFormerDwwm"> - Ancien DWWM</span>
          </li>
        </ul>
      </div>
    </div>

    <!-- Bouton de suppression -->
    <div class="text-center" *ngIf="list.generatedGroups?.length > 0">
      <button class="btn btn-danger-custom" (click)="clearGroups()">
        Supprimer les groupes
      </button>
    </div>
  </div>

  <!-- Formulaire de renommage des groupes -->
  <div *ngIf="list.showSavedGroups && list.groupNames?.length > 0" class="card p-4 mb-4 border border-custom rounded">
    <div *ngFor="let group of list.generatedGroups; let i = index" class="mb-3">
      <label [for]="'groupName' + i" class="form-label fw-semibold">
        Nom du groupe {{ i + 1 }} :
      </label>
      <input
        type="text"
        class="form-control"
        [id]="'groupName' + i"
        [(ngModel)]="list.groupNames[i]"
      />
    </div>

    <div class="text-center">
      <button class="btn btn-primary" (click)="updateGroupNames(list)">
        Mettre Ã  jour les noms
      </button>
    </div>
  </div>

  <!-- Message d'erreur -->
  <div *ngIf="errorMessage" class="alert alert-danger text-center">
    {{ errorMessage }}
  </div>

  <!-- Historique des groupes -->
  <app-group-history *ngIf="list" [listId]="list.id"></app-group-history>
</div>
